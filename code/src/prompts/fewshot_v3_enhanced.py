"""
Few-shot 강화 프롬프트 v3 Enhanced

전문가 조언 반영:
- 기존 예시 길이 줄이기 (긴 예시는 부담)
- 금지 패턴 직접 명시
- 출력 규칙 3개만 추가 (간결하게)
"""

from .base import BasePrompt


class FewShotV3EnhancedPrompt(BasePrompt):
    """
    Few-shot v3 Enhanced 프롬프트

    개선 사항:
    - 긴 예시 (능동피동 296자 등) 짧은 예시로 교체
    - 금지 패턴 구체적으로 명시
    - 출력 규칙 간결하게 (3개)
    """

    @property
    def name(self) -> str:
        """프롬프트 이름 반환"""
        return "fewshot_v3_enhanced"

    def system_message(self) -> str:
        """시스템 메시지 반환 (사용하지 않음)"""
        return ""

    def format_user_message(self, text: str) -> str:
        """
        사용자 메시지 포맷팅

        Args:
            text: 교정할 원문 텍스트

        Returns:
            str: Few-shot 예시가 포함된 프롬프트
        """
        template = """# 교정 규칙

1. 맞춤법, 띄어쓰기, 문장 부호, 문법 오류만 교정합니다.
2. 교정된 문장만 한 줄로 출력합니다.
3. 설명, 레이블, 메타데이터 출력 금지:
   - 금지: "원문:", "교정:", "수정:", "결과:"
   - 금지: ※, [...], 추가 설명
   - 금지: 줄바꿈, 반복 출력

# 교정 예시

<원문>
그가 케네디 정책이라는 점을 연관이 부각해 당위성을 강조하려는 분석이 제기된다.
<교정>
그가 케네디 정책이라는 점을 부각해 당위성을 강조하려는 분석이 제기된다.

<원문>
2014년 3만달러를 넘은 지 4만달러까지 가는데 15년이 걸릴 것으로 본 것이다.
<교정>
2014년 3만달러를 넘었고, 4만달러까지 가는데 15년이 걸릴 것으로 본 것이다.

<원문>
시민연대(시민연대는) 이날 오전 10시부터 집회를 연다.
<교정>
시민연대(시민연대)는 이날 오전 10시부터 집회를 연다.

<원문>
영국의 요구가 비현실적이라는 지적이 나왔다..
<교정>
영국의 요구가 비현실적이라는 지적이 나왔다.

<원문>
벽에 부딪쳐 넘어졌다.
<교정>
벽에 부딪혀 넘어졌다.

<원문>
작년 국내 자동차 판매량 SUV 비중이 절반이 넘었다.
<교정>
작년 국내 자동차 판매량 중 SUV 비중이 절반이 넘었다.

<원문>
3명에 불과했다. 학사 원칙에 따라 유급 처분을 받게 된다.
<교정>
3명에 불과했다. 이들은 학사 원칙에 따라 유급 처분을 받게 된다.

<원문>
직접 가위를 이용해 직접 손으로 하던 작업이다.
<교정>
가위를 이용해 직접 손으로 하던 작업이다.

<원문>
고객 납기 기간에 맞춰 로봇에 명령이 내려진다.
<교정>
고객 납기에 맞춰 로봇에 명령이 내려진다.

<원문>
폭이 230㎜, 15㎜씩 늘어났다.
<교정>
길이 230㎜, 폭 15㎜가 늘어났다.

<원문>
원수 지간이 됐다.
<교정>
원수지간이 됐다.

<원문>
교관 메뉴얼도 학습한다.
<교정>
교관 매뉴얼도 학습한다.

# 교정할 문장
<원문>
{text}
<교정>"""

        return template.format(text=text)
